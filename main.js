/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{d:()=>l});let t=(()=>{let e=()=>{let e=document.getElementById("buttonContainer");t(e);let n=document.createElement("form");n.setAttribute("id","buttonForm");let a=document.createElement("input");a.setAttribute("id","buttonFormInput"),a.type="text",a.name="taskName",n.appendChild(a),e.appendChild(n),a.focus()},t=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)};return{makeButton:n=>{console.log(`input:${n}`),null!=n&&(console.log("can push"),(e=>{console.log(e),tasks.construct(e),tasks.load(),status.init()})(n));let a=document.getElementById("buttonContainer");t(a);let d=document.createElement("div"),l=document.createTextNode("+ New Task");d.appendChild(l),d.setAttribute("id","newTaskButton"),a.appendChild(d),d.addEventListener("click",e)},makeForm:e}})();let n=(()=>{let e=[],t=()=>{let e=(new Date).toLocaleDateString(),t=e.split("/"),n=t[0],a=t[1];return n=n.padStart(3,"0").slice(-2),a=a.padStart(3,"0").slice(-2),t[0]=t[2],t[1]=n,t[2]=a,e=t.join("-"),e},n=(e,t,n)=>{let a,d=0;a=e%400==0||e%100!=0&&e%4==0,console.log("is leap year:",a);for(let e=1;e<t;e++)d+=e%2!=0?31:2===e?a?29:28:30;return d+=n,Math.ceil(d/7)},a=e=>{console.log(`tasksToLoad: ${l}`);let t=document.getElementById("taskContainer");o(t);for(let n in e){console.log(`tasksToLoad: ${l}`);let a=document.createElement("div");a.classList.add("task");let o=document.createElement("div");o.classList.add("taskStatus");let r=document.createElement("div");r.classList.add("notDone");let s=document.createElement("i");s.classList.add("far","fa-circle");let i=document.createElement("div");i.classList.add("taskTextContainer");let c=document.createElement("p");c.classList.add("taskText");let m=document.createTextNode(e[n][0]),u=document.createElement("form");u.classList.add("taskDate");let p=document.createElement("label");p.for="dueDate";let h=document.createElement("input");h.type="date",h.classList.add("dueDate"),h.name="dueDate",e[n][1]&&(h.value=e[n][1]),u.appendChild(p),u.appendChild(h),r.prepend(s),c.appendChild(m),i.appendChild(c),d(i),o.appendChild(r),o.appendChild(i),a.appendChild(o),a.appendChild(u),t.appendChild(a)}},d=e=>{let t=e.firstChild;t.addEventListener("click",(()=>{t.remove();let n=document.createElement("form");n.classList.add("newTextForm");let a=document.createElement("input");a.type="text",a.name="newTaskName",a.classList.add("newTextInput"),n.appendChild(a),n.addEventListener("submit",(()=>{o(e);let t=document.createElement("p");t.classList.add("taskText");let n=document.createTextNode(a.value);t.appendChild(n),e.appendChild(t),d(e)})),e.appendChild(n)}))},o=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)};return{loadInbox:()=>{a(e)},loadToday:()=>{let n=[],d=t();for(let t in e)console.log("under"),e[t].length>1&&e[t][1]===d&&n.push(e[t]);console.log(n),a(n)},loadWeek:()=>{let t=((e=new Date)=>{const t=(e.getDay()+6)%7,n=new Date(e);n.setDate(e.getDate()-t+3);const a=new Date(n.getFullYear(),0,1);return 4!==a.getDay()&&a.setMonth(0,1+(11-a.getDay())%7),1+Math.floor((n-a+(d=n,6e4*(a.getTimezoneOffset()-d.getTimezoneOffset())))/6048e5);var d})(new Date),d=[];for(let a in e)if(e[a][1]){let l=e[a][1].split("-"),o=parseInt(l[0]),r=parseInt(l[1]),s=parseInt(l[2]);n(o,r,s)===t&&d.push(e[a])}console.log(d),a(d)},construct:n=>{"today"===l?e.push([n,t()]):e.push([n]),console.log("task array is",e)},taskArray:e}})(),a={init:()=>{document.querySelectorAll(".notDone").forEach((e=>{e.addEventListener("click",(()=>{(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)})(e);let t=document.createElement("i");t.classList.add("fas","fa-check-circle"),e.prepend(t);let a=e.parentNode.parentNode;n.taskArray.splice(Array.from(a.parentNode.children).indexOf(a),1),a.classList.add("fadingTask"),setTimeout((()=>{taskContainer.removeChild(e.parentNode.parentNode)}),500)}))}))}},d=()=>{console.log("changes..."),document.querySelectorAll(".dueDate").forEach((e=>{e.addEventListener("change",(()=>{let t=e.value,a=e.parentNode.parentNode,d=n.taskArray[Array.from(a.parentNode.children).indexOf(a)];d.length>1&&d.pop(),d.push(t)}))}))},l="inbox",o=()=>{document.getElementById("newTaskButton").addEventListener("click",(()=>{t.makeForm(),r()}))},r=()=>{let e=document.getElementById("buttonForm"),l=document.getElementById("buttonFormInput");e.addEventListener("submit",(()=>{let e=l.value;n.construct(e),s(),a.init(),d(),t.makeButton(),o()}))},s=()=>{"inbox"===l?n.loadInbox():"today"===l?n.loadToday():"week"===l&&n.loadWeek()},i=e=>{document.getElementById("taskTabTitle").textContent=e},c=document.getElementById("inbox"),m=document.getElementById("today"),u=document.getElementById("week");c.addEventListener("click",(()=>{l="inbox",s(),a.init(),d(),i("Inbox")})),m.addEventListener("click",(()=>{l="today",s(),a.init(),d(),i("Today")})),u.addEventListener("click",(()=>{l="week",s(),a.init(),d(),i("This Week")})),t.makeButton(),o()})();